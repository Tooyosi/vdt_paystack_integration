<%- include ('../partials/header.ejs')%>
<div class="row">
    <div class="col-lg-12">
        <p>Search</p>
    </div>
    <form action="" method="get" class="form-inline">
        <div class="form-group">
            <input type="text" name="subsId" placeholder="Subscriber Id" class="form-control">
        </div>
        <div class="form-group">
            <input type="text" name="ref" placeholder="Transaction reference" class="form-control">
        </div>
        <div class="form-group">
            <input type="text" name="email" placeholder="Email" class="form-control">
        </div>
        <div class="form-group">
            <input type="text" name="amount" placeholder="Amount" class="form-control">
        </div>
        <div class="form-group">
            <input type="text" name="status" placeholder="status" class="form-control">
        </div>
        <div class="form-group">
            <input type="date" name="date" placeholder="date" class="form-control">
        </div>
        <div class="">
            <button type="submit" class="btn btn-success">Search</button>
        </div>
    </form>
    <div class="col-lg-12">
        <a class="btn btn-success" href="/admin/download?page=<%= Number(current)%><%if(subsId){%>&subsId=<%=subsId%><%}%><%if(ref){%>&ref=<%=ref%><%}%><%if(email){%>&email=<%=email%><%}%><%if(amount){%>&amount=<%=amount%><%}%><%if(status){%>&status=<%=status%><%}%><%if(date){%>&date=<%=date%><%}%>">Export</a>
    </div>
    <div class="table-responsive">
        <table class="table table-striped">
            <thead>
                <th>No</th>
                <th>Subscriber Id</th>
                <th>Customer Name</th>
                <th>Customer Phone</th>
                <th>Customer Email</th>
                <th>Transaction Reference</th>
                <th>Transaction Amount</th>
                <th>Transaction Status</th>
                <th>Payment Date</th>
                <th>Post Amount Status</th>
                <th>Alepo Payment Number</th>
            </thead>
            <tbody>
                <% data.forEach((transaction, i)=>{%>
                <tr>
                    <td><%=(i + 1)%></td>
                    <td><%=transaction.subscriber_id%></td>
                    <td><%=transaction.customer_firstname%> <%=transaction.customer_lastname%></td>
                    <td><%=transaction.customer_phone%></td>
                    <td><%=transaction.customer_email%></td>
                    <td><%=transaction.transaction_ref%></td>
                    <td>&#8358; <%=transaction.amount%></td>
                    <td><%=transaction.transaction_status%></td>
                    <td><%=transaction.payment_date%></td>
                    <td><%=transaction.post_amount_status%></td>
                    <td><%=transaction.payment_number_alepo%></td>

                </tr>
                <%})%>
            </tbody>
        </table>
    </div>
</div>
<div class="row text-center">
    <% if(pages && pages > 0){%>
    <ul class="pagination text-center">
        <%if (current == 1){%>
        <li class="page-item disabled"><a class="page-link">«</a></li>
        <%} else { %>
        <li class="page-item"><a class="page-link" href="/admin/home?page=<%= Number(current) - 1%><%if(subsId){%>&subsId=<%=subsId%><%}%><%if(ref){%>&ref=<%=ref%><%}%><%if(email){%>&email=<%=email%><%}%><%if(amount){%>&amount=<%=amount%><%}%><%if(status){%>&status=<%=status%><%}%><%if(date){%>&date=<%=date%><%}%>">First</a></li>
            <%}%>
            <% var i = (Number(current) > 5 ? Number(current) - 4 : 1) %>
            <% if (i !== 1) { %>
            <li class=" disabled page-item"><a>...</a></li>
        <% } %>
        <% for (; i <= (Number(current) + 4) && i <= pages; i++) { %>
        <% if (i == current) { %>
        <li class="active page-item"><a class="page-link"><%= i %></a></li>
        <% } else { %>
        <li class="page-item"><a class="page-link" href="/admin/home?page=<%= i %><%if(subsId){%>&&subsId=<%=subsId%><%}%><%if(ref){%>&&ref=<%=ref%><%}%><%if(email){%>&&email=<%=email%><%}%><%if(amount){%>&&amount=<%=amount%><%}%><%if(status){%>&&status=<%=status%><%}%><%if(date){%>&date=<%=date%><%}%>"><%= i %></a></li>
            <% } %>
            <% if (i == Number(current) + 4 && i < pages) { %>
            <li class=" disabled page-item"><a class="page-link">...</a></li>
        <% } %>
        <% } %>

        <% if (current == pages) { %>
        <li class="disabled page-item"><a class="page-link">»</a></li>
        <% } else { %>
        <li class="page-item"><a class="page-link" href="/admin/home?page=<%= Number(current) + 1 %><%if(subsId){%>&subsId=<%=subsId%><%}%><%if(ref){%>&ref=<%=ref%><%}%><%if(email){%>&email=<%=email%><%}%><%if(amount){%>&amount=<%=amount%><%}%><%if(status){%>&status=<%=status%><%}%><%if(date){%>&date=<%=date%><%}%>">»</a></li>
            <% } %>
            
            <% if (current == pages) { %>
            <li class=" disabled page-item"><a class="page-link">Last</a></li>
        <% } else { %>
        <li class="page-item"><a class="page-link" href="/admin/home?page=<%= pages %><%if(subsId){%>&subsId=<%=subsId%><%}%><%if(ref){%>&ref=<%=ref%><%}%><%if(email){%>&email=<%=email%><%}%><%if(amount){%>&amount=<%=amount%><%}%><%if(status){%>&status=<%=status%><%}%><%if(date){%>&date=<%=date%><%}%>">Last</a></li>
            <% } %>
        </ul>
        <% } %>
</div>
<%- include ('../partials/footer.ejs')%>